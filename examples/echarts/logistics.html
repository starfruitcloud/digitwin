<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>dc-example</title>
  <script src='/libs/dc-sdk/dc.min.js'></script>
  <script src='../echarts.min.js'></script>
  <link href='/libs/dc-sdk/dc.min.css' type='text/css' rel='stylesheet'>
  <link href='../index.css' type='text/css' rel='stylesheet'>
</head>

<body>

<div id="viewer-container" class="viewer-container"></div>

<script>
  let viewer = undefined

  function initViewer() {
    viewer = new DC.Viewer('viewer-container')
    let baseLayer = DC.ImageryLayerFactory.createImageryLayer(DC.ImageryType.AMAP,{
      crs:'WGS84'
    })
    viewer.addBaseLayer( baseLayer,{
      brightness : 0.1
    })
    let layer = new DC.ChartLayer('layer',viewer)
    layer.setOption(getOption())
    viewer.addLayer(layer)
    viewer.flyToPosition("115.79782534952115,31.47385026585756,4856091.799441838,0,-90")
  }

  function getOption(e) {
    let chinaGeoCoordMap = {
      ÈªëÈæôÊ±ü: [127.9688, 45.368],
      ÂÜÖËíôÂè§: [110.3467, 41.4899],
      ÂêâÊûó: [125.8154, 44.2584],
      Âåó‰∫¨Â∏Ç: [116.4551, 40.2539],
      ËæΩÂÆÅ: [123.1238, 42.1216],
      Ê≤≥Âåó: [114.4995, 38.1006],
      Â§©Ê¥•: [117.4219, 39.4189],
      Â±±Ë•ø: [112.3352, 37.9413],
      ÈôïË•ø: [109.1162, 34.2004],
      ÁîòËÇÉ: [103.5901, 36.3043],
      ÂÆÅÂ§è: [106.3586, 38.1775],
      ÈùíÊµ∑: [101.4038, 36.8207],
      Êñ∞ÁñÜ: [87.9236, 43.5883],
      Ë•øËóè: [91.11, 29.97],
      ÂõõÂ∑ù: [103.9526, 30.7617],
      ÈáçÂ∫Ü: [108.384366, 30.439702],
      Â±±‰∏ú: [117.1582, 36.8701],
      Ê≤≥Âçó: [113.4668, 34.6234],
      Ê±üËãè: [118.8062, 31.9208],
      ÂÆâÂæΩ: [117.29, 32.0581],
      ÊπñÂåó: [114.3896, 30.6628],
      ÊµôÊ±ü: [119.5313, 29.8773],
      Á¶èÂª∫: [119.4543, 25.9222],
      Ê±üË•ø: [116.0046, 28.6633],
      ÊπñÂçó: [113.0823, 28.2568],
      Ë¥µÂ∑û: [106.6992, 26.7682],
      ‰∫ëÂçó: [102.9199, 25.4663],
      Âπø‰∏ú: [113.12244, 23.009505],
      ÂπøË•ø: [108.479, 23.1152],
      Êµ∑Âçó: [110.3893, 19.8516],
      ‰∏äÊµ∑: [121.4648, 31.2891]
    }
    let chinaDatas = [
      [
        {
          name: 'ÈªëÈæôÊ±ü',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÂÜÖËíôÂè§',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÂêâÊûó',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ËæΩÂÆÅ',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Ê≤≥Âåó',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Â§©Ê¥•',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Â±±Ë•ø',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÈôïË•ø',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÁîòËÇÉ',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÂÆÅÂ§è',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÈùíÊµ∑',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Êñ∞ÁñÜ',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Ë•øËóè',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÂõõÂ∑ù',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÈáçÂ∫Ü',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Â±±‰∏ú',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Ê≤≥Âçó',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Ê±üËãè',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÂÆâÂæΩ',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÊπñÂåó',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÊµôÊ±ü',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Á¶èÂª∫',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Ê±üË•ø',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÊπñÂçó',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Ë¥µÂ∑û',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'ÂπøË•ø',
          value: 0,
          price: 100,
          num: 2
        }
      ],
      [
        {
          name: 'Êµ∑Âçó',
          value: 0,
          price: 100,
          num: 2
        }
      ]
    ]
    let convertData = function(data) {
      let res = []
      for (let i = 0; i < data.length; i++) {
        let dataItem = data[i]
        // 			console.log('dataItem',dataItem) //Á¨¨‰∫å‰∏™Êï∞ÊçÆ
        let fromCoord = [116.4551, 40.2539]
        let toCoord = chinaGeoCoordMap[dataItem[0].name]
        // 			console.log('toCoord',toCoord);//Á¨¨‰∏Ä‰∏™Âú∞ÂùÄ
        if (fromCoord && toCoord) {
          res.push([
            {
              coord: fromCoord,
              value: dataItem[0].value
            },
            {
              coord: toCoord,
              dataItem: dataItem
            }
          ])
        }
      }
      return res
    }
    let redName = 'Êñ∞ÁñÜ'
    let planePath =
      'path://M.6,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705'

    let series = []
    ;[['Âåó‰∫¨Â∏Ç', chinaDatas]].forEach(function(item, i) {
      series.push(
        {
          type: 'lines',
          coordinateSystem: 'GLMap',
          zlevel: 2,
          effect: {
            show: true,
            period: 4, //ÁÆ≠Â§¥ÊåáÂêëÈÄüÂ∫¶ÔºåÂÄºË∂äÂ∞èÈÄüÂ∫¶Ë∂äÂø´
            trailLength: 0.1, //ÁâπÊïàÂ∞æËøπÈïøÂ∫¶[0,1]ÂÄºË∂äÂ§ßÔºåÂ∞æËøπË∂äÈïøÈáç
            symbol: 'circle', //ÁÆ≠Â§¥ÂõæÊ†á
            symbolSize: 3, //ÂõæÊ†áÂ§ßÂ∞è
            color: '#fff'
          },
          lineStyle: {
            normal: {
              width: 0.7, //Â∞æËøπÁ∫øÊù°ÂÆΩÂ∫¶
              opacity: 0.5, //Â∞æËøπÁ∫øÊù°ÈÄèÊòéÂ∫¶
              curveness: 0.2, //Â∞æËøπÁ∫øÊù°Êõ≤Áõ¥Â∫¶
              color: function(params) {
                return '#ffa022'
              }
            },
            color: 'red'
          },
          data: convertData(item[1])
        },
        {
          type: 'effectScatter',
          coordinateSystem: 'GLMap',
          zlevel: 2,
          rippleEffect: {
            //Ê∂üÊº™ÁâπÊïà
            period: 4, //Âä®ÁîªÊó∂Èó¥ÔºåÂÄºË∂äÂ∞èÈÄüÂ∫¶Ë∂äÂø´
            brushType: 'fill', //Ê≥¢Á∫πÁªòÂà∂ÊñπÂºè stroke, fill
            scale: 2.2 //Ê≥¢Á∫πÂúÜÁéØÊúÄÂ§ßÈôêÂà∂ÔºåÂÄºË∂äÂ§ßÊ≥¢Á∫πË∂äÂ§ß
          },

          // Êã¨ 'circle', 'rect', 'roundRect', 'triangle', 'diamond', 'pin', 'arrow', 'none'
          // symbol: 'none',
          symbol: 'circle',
          symbolSize: function(val) {
            return 5 //ÂúÜÁéØÂ§ßÂ∞è
          },
          itemStyle: {
            normal: {
              show: false,
              // color: '#f00'
              color: function(params) {
                //ÂúÜÁéØÊòæÁ§∫ÊñáÂ≠ó
                // console.log('redName',redName)

                return '#ffa022'
              },
              borderWidth: 0,
              shadowColor: '#b5e8fa', //ÂèëÂÖâüâêÊïàÊûú
              shadowBlur: 4
            }
          },
          data: item[1].map(function(dataItem) {
            // 	console.log('dataItem',dataItem[0]);
            return {
              dataItem: dataItem,
              name: dataItem[0].name,
              value: chinaGeoCoordMap[dataItem[0].name].concat([
                dataItem[0].value
              ])
            }
          })
        },
        //Ë¢´ÊîªÂáªÁÇπ
        {
          type: 'scatter',
          coordinateSystem: 'GLMap',
          zlevel: 1,
          rippleEffect: {
            period: 4,
            brushType: 'stroke',
            scale: 4
          },

          symbol: 'circle',
          color: 'rgba(128, 220, 251, .6)',
          symbolSize: 20,
          data: [
            {
              name: item[0],
              value: chinaGeoCoordMap[item[0]].concat([10])
            }
          ]
        }
      )
    })

    return {
      series
    }
  }

  DC.ready({
    baseUrl:'../libs/dc-sdk/resources/',
    echarts: window.echarts
  }).then(initViewer)
</script>
</body>
</html>
